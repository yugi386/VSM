ğŸ“Š Automated VSM Analyzer (Video Process Mining)
Este repositÃ³rio contÃ©m uma ferramenta de Process Mining e VSM (Value Stream Mapping) automatizado. A ferramenta processa gravaÃ§Ãµes de tela (vÃ­deos de operaÃ§Ãµes em sistemas ERP, Web, etc.) e utiliza VisÃ£o Computacional (OpenCV) e OCR (Tesseract) para gerar relatÃ³rios detalhados de eficiÃªncia, tempos e movimentos.

O sistema identifica automaticamente quando o usuÃ¡rio estÃ¡ digitando, clicando, rolando a tela ou esperando o sistema carregar, gerando um Excel com a linha do tempo completa e grÃ¡ficos de intensidade.

ğŸš€ Funcionalidades
ConversÃ£o AutomÃ¡tica: O script bash converte vÃ­deos (.mp4, .avi, etc.) em sequÃªncias de frames PDF prontos para OCR.

OCR Inteligente: LÃª tÃ­tulos de janelas e rodapÃ©s (ex: mensagens de status do SAP) para identificar em qual tela o usuÃ¡rio estÃ¡.

ClassificaÃ§Ã£o de AÃ§Ãµes:

ğŸŸ¢ DigitaÃ§Ã£o (VA - Valor Agregado): Detecta inserÃ§Ã£o de dados.

ğŸ”µ Clique/SeleÃ§Ã£o: Detecta interaÃ§Ã£o com mouse e menus.

ğŸŸ£ Pop-up/Sistema: Identifica janelas modais ou sub-telas.

ğŸŸ  Scroll: Detecta rolagem de tela (tempo a ser otimizado).

ğŸ”´ MudanÃ§a de Tela: Identifica navegaÃ§Ã£o entre transaÃ§Ãµes/pÃ¡ginas.

RelatÃ³rios AutomÃ¡ticos:

GrÃ¡fico de intensidade de atividade (Timeline visual).

Excel com mÃ©tricas de eficiÃªncia (Lead Time, Tempo de Input vs. Tempo de Sistema).

CatÃ¡logo de telas acessadas.

ğŸ› ï¸ PrÃ©-requisitos e DependÃªncias
Para que o analisador funcione, vocÃª precisa de algumas ferramentas de sistema instaladas, alÃ©m das bibliotecas Python.

1. Ferramentas de Sistema (System Packages)
Este projeto depende de ferramentas externas. Instale-as conforme seu sistema operacional:

Linux (Ubuntu/Debian/Mint):

Bash

sudo apt-get update
sudo apt-get install ffmpeg tesseract-ocr tesseract-ocr-por poppler-utils
Nota: O pacote tesseract-ocr-por Ã© essencial pois o script estÃ¡ configurado para ler portuguÃªs (lang="por").

Windows:

FFmpeg: Baixe e adicione ao PATH do sistema.

Tesseract OCR: Baixe o instalador (ex: UB-Mannheim), instale incluindo o pacote de idioma "Portuguese", e adicione o caminho ao PATH.

Poppler: Baixe os binÃ¡rios do poppler e adicione a pasta bin ao PATH.

2. Bibliotecas Python
Recomenda-se usar um ambiente virtual (venv). Crie um arquivo requirements.txt com o seguinte conteÃºdo e instale-o:

Plaintext

opencv-python
numpy
pdf2image
pandas
matplotlib
pytesseract
openpyxl
img2pdf
Instale com:

Bash

pip install -r requirements.txt
ğŸ“‚ Estrutura do Projeto
analisador13.py: Script principal. Gerencia threads, processamento de imagem, lÃ³gica de decisÃ£o (Digitando vs Clicando) e geraÃ§Ã£o do Excel.

preparar_batch.sh: Script auxiliar chamado automaticamente pelo Python. Usa ffmpeg para extrair frames dos vÃ­deos e img2pdf para consolidÃ¡-los.

â–¶ï¸ Como Usar
Coloque seus arquivos de vÃ­deo (ex: gravacao_sap.mp4) na mesma pasta dos scripts.

DÃª permissÃ£o de execuÃ§Ã£o para o script bash (apenas na primeira vez, se estiver no Linux/Mac):

Bash

chmod +x preparar_batch.sh
Execute o script Python:

Bash

python analisador13.py
O que vai acontecer?
O script chamarÃ¡ o bash para converter todos os vÃ­deos da pasta em arquivos .pdf temporÃ¡rios.

O Python iniciarÃ¡ a leitura dos PDFs usando ThreadPoolExecutor (multithreading).

SerÃ¡ gerado um arquivo de log debug_log.txt (opcional) e mensagens de progresso no terminal.

Ao final, dois arquivos serÃ£o gerados para cada vÃ­deo:

grafico_[nome_do_video].png: GrÃ¡fico visual da operaÃ§Ã£o.

relatorio_[nome_do_video].xlsx: RelatÃ³rio completo.

ğŸ“Š Entendendo o RelatÃ³rio (Excel)
O Excel gerado possui as seguintes abas:

Resumo de Dados: KPIs gerais (Tempo Total, Tempo de Input, EficiÃªncia Operacional %).

Timeline Detalhada: Linha a linha de cada segundo do vÃ­deo com a classificaÃ§Ã£o da aÃ§Ã£o.

CatÃ¡logo Telas: Lista sequencial de quais telas foram acessadas.

DicionÃ¡rio Telas: IDs Ãºnicos para cada tela identificada (ex: T01, T02).

Tempo de processo por tela: Quanto tempo o usuÃ¡rio ficou em cada tela especÃ­fica.

âš™ï¸ ConfiguraÃ§Ãµes AvanÃ§adas
No inÃ­cio do arquivo analisador13.py, vocÃª pode ajustar:

Python

FPS_CONFIG = 1      # Frames por segundo a analisar (1 Ã© recomendado para performance)
MAX_WORKERS = 8     # NÃºmero de threads simultÃ¢neas para OCR
GERAR_LOG_DEBUG = False # Mude para True para ver detalhes da decisÃ£o do algoritmo
ğŸ› Troubleshooting Comum
Erro "tesseract is not installed": Certifique-se de que instalou o binÃ¡rio do Tesseract no sistema e que ele estÃ¡ acessÃ­vel via terminal.

Erro "pdfinfo_from_path": Indica que o poppler-utils nÃ£o estÃ¡ instalado ou nÃ£o estÃ¡ no PATH.

AcurÃ¡cia Baixa: Verifique se a resoluÃ§Ã£o do vÃ­deo Ã© boa. O OCR depende de clareza visual. O script aplica filtros (upscale, threshold), mas vÃ­deos muito comprimidos podem falhar.
